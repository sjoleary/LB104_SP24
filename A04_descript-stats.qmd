# Introduction to descriptive statistics {#sec-introduction-to-descriptive-statistics}

```{r}
#| label: set-up
#| include: false

# set options
knitr::opts_chunk$set(
  tidy = FALSE, 
  message = FALSE,
  warning = FALSE)

options(htmltools.dir.version = FALSE)

```

## Learning Objectives {#sec-learning-objectives}

**After completing this activity, you should be able to**

-   Define descriptive statistics and describe its role in summarizing and describing data sets.
-   Visualize counts of categorical data using bar plots and explain how to interpret them.
-   Visualize distributions of continuous data using histograms and explain how to interpret them.
-   Recognize and explain how to calculate measures of central tendency, including mean, median, and mode, and understand when each is appropriate to use.
-   Recognize and explain how to calculate measures of variability, including range, variance, and explain how they describe the spread of data.
-   Use `R` to calculate standard descriptive statistics.

**Quantitative research** is a core component of the natural sciences, including biology. Here, we collect and analyze numerical data[^a04_descript-stats-1] to find patterns and averages, test causal relationships, generalize results based on a specific sample to the whole population and be able to make predictions beyond that specific case. Over the last few decades the availability of computational power and the ability to generate increasingly large data sets[^a04_descript-stats-2] means that arguably all biology has become computational biology and your ability to apply statistics is increasingly essential to pursue a career in most biological fields including genetics, ecology, animal behavior, environmental science etc. This semester as you design different research projects you will learn how analyze data using `R`.

[^a04_descript-stats-1]: data is plural, a single numerical observation would be a **datum**

[^a04_descript-stats-2]: This is why we frequently also call this the "Era of Big Data".

After you have performed an observational or controlled experiment and compiled your individual observations into a **data set**, your next step will be to analyze that data and draw conclusions from the data using statistics. The goal of **descriptive statistics** is to summarize and describe the characteristics of a data set. By contrast, **inferential statistics** are applied to allow you to make generalizations about the population based on your sample or to test a specific **hypothesis**.

## Organizing and summarizing raw data using descriptive statistics {#sec-organizing-and-summarizing-raw-data-using-descriptive-statistics}

To learn how to use `R` to generate descriptive statistics we are going to explore a data set collected from 2007 to 2009 by Dr. Kristen Gorman with the Palmer Station Long Term Ecological Research Program which is part of the US Long Term Ecological Research Network [@gormanEcologicalSexualDimorphism2014]. We are going to use a curated version[^a04_descript-stats-3] of the data set.

[^a04_descript-stats-3]: This means that the data wrangling has already been done for us and we can directly access a tidy data set.

Executing the following code chunk[^a04_descript-stats-4] to install an `R` package holding the Palmer Penguins data set.

[^a04_descript-stats-4]: You will only have to do this once. Note that the `eval` option of your code chunk is set to `false` so that when you render your document it will not execute this code chunk

```{r}
#| eval: false

install.packages("palmerpenguins")

```

Now we can get started by loading several `R` libraries, including the `palmerpenguins` library, that contain the functions we will need to explore this data set

```{r}
#| echo: false

# load libraries for reporting
library(knitr)

# load libraries for data wrangling
library(dplyr)
library(tidyr)
library(tibble)

# load libraries for plotting
library(ggplot2)
library(ggthemes)

# load dataset
library(palmerpenguins)

```

Let's take a quick look at what variables the data set contains using the function `glimpse()`.

```{r}

# overview of rows and columns
glimpse(penguins)

```

You can also use the function `View()` to open the `data.frame` in the Viewer Pane.

```{r}
#| eval: false

# open dataframe in Viewer
View(penguins)

```

We generally differentiate between two different types of variables:

-   **Continuous variables** are numeric variables that can take any value within a given range; they are typically measured on interval or ratio scales[^a04_descript-stats-5], allowing for meaningful mathematical operations like addition and subtraction.
-   **Categorical variables** represent categories or groups and can take on a limited, distinct set of values; they are either measured on a nominal scale[^a04_descript-stats-6] or an ordinal scale[^a04_descript-stats-7].

[^a04_descript-stats-5]: These are both types quantitative scales: An interval scale is a measurement scale where the intervals between consecutive values are equal, but the scale lacks a true zero point. A ratio scale has the same properties but also a true zero point indicating the absence of the measured quantity making the ratios of measurements meaningful.

[^a04_descript-stats-6]: Categories are assigned labels with no inherent order or ranking

[^a04_descript-stats-7]: There is a meaningful order to the categories.

::: {.callout-tip title="Consider this"}
Take a look at the data set in the Viewer Pane and get an overview of what information it contains.

-   How many different species were included?
-   On how many islands where observations made?
-   When were the observations made?
-   What biological measurements were taken?
-   How many individual observations are there?

Indicate which of these variables are **continuous** and which are **categorical** variables.
:::

::: {.callout-note title="Answer" collapse="true"}
You can see that we observations of three different species of penguins (Adelie, Chinstrap, Gentoo) on three different islands in the Antarctica (Togersen, Dream, Biscoe). These are all categorical variables.

The biological measurements include sex (categorical variable) as well as several continuous measurements:

-   body mass
-   flipper length
-   beak measurements (depth, length)
:::

As you probably noticed having to scroll through **raw data**[^a04_descript-stats-8] on 344 individuals that were observed, it is difficult to get much information on general patterns. You were probably able to scroll through and figure out how many different islands were observed and what species were counted and that both males and females were observed - but would you be able to make a statement about whether some species are more common on some islands compared to others? Whether there are more males or females in the data set? If there are differences in size among species? Among sexes within species? What a typical beak size looks like?

[^a04_descript-stats-8]: Unprocessed data comprising all the individual observations.

Generally our first step in analyzing a data set would be to apply descriptive statistics to summarize the data and identify the following three characteristics

1.  Frequency Distribution
2.  Measures of central tendency
    -   mean
    -   median
    -   mode
3.  Measures of variability
    -   range
    -   standard deviation
    -   variance
    -   interquartile range

You can apply these statistics to assess only one variable at a time (**univariate analysis**) or to compare two (**bivariate analysis**) or more (**multivariate analysis**) variables.

After we have calculated our descriptive statistics we will generally visualize them as either a **table** or **graph**. A **table** allows us to organize values into columns and rows. While we frequently gather and organize our raw data into tables, any tables you are presenting in a report should be summarized data. Generally, we reserve tables for complex data that is not easily visualized or include them in an appendix for anyone who needs very specific details. Instead whenever possible we translate tables into a **graph** or **plot** which makes it easier to show the relationship between variables and identify trends and patterns, the most commonly used graphs are scatter plots, line plots, box plots, bar plots, and histograms[^a04_descript-stats-9].

[^a04_descript-stats-9]: Today you will use bar plots and histograms to visualize summary statistics.

## Frequency Distribution {#sec-frequency-distribution}

### Simple frequency distribution {#sec-simple-frequency-distribution}

Every data set is made up of a distribution of values. We can summarize the frequency of every possible value of a variable using either counts or by indicating the proportion of all observations that take on a specific value.

For example we might want to know how many individuals of each species where observed in the data set. To do this we would create a frequency distribution table that lists every possible value or measurement (in this case the species) and the how many times each value was observed.

We can have `R` do the work for us using the function `count()`and specifying which column the number of observations per value should be counted for[^a04_descript-stats-10].

[^a04_descript-stats-10]: You will frequently see that we link lines of codes using `%>%` which is called a "pipe". You can interpret this as you telling R "and now do this". The reason we call this piping is tha the first line of code creates and output and then we are saying "take this output and now make that the input and do this" as if we were creating a giant marble run.

```{r}

# count number of individual per species
penguins %>%
  count(species) %>%
  kable()

```

Frequently, it is more helpful to compare relative proportions. We can do this by creating a new column using the function `mutate()`. Then, we give it the column name for the column we want to create and define how the content for each row should be calculated based on existing values. In this case, we divide the content of column `n` (which contains the counts) by the number of individuals observed by the total number of all penguins in the data set which we can calculate as `sum(n)`.

```{r}

# create frequency table
penguins %>%
  count(species) %>%                 # count number of observations
  mutate(percent = n/sum(n)*100) %>% # calculate percent
  kable(digits = 1)                  # print table with 1 digit

```

::: {.callout-tip title="Consider this"}
Describe your results and consider what this tells you about penguins in the Antarctica.
:::

::: {.callout-note title="Answer" collapse="true"}
This gives us some insight into fundamental patterns of species richness and diversity. We know there are three species observed (richness) and the relative abundance (Adelie penguins are the most commonly at 44% while Chinstrap penguins are the most rare at 19%).
:::

Determining the number of observations and relative proportions is an important descriptive statistic for any **categorical** variable.

::: {.callout-tip title="Give it a try"}
Modify/complete the code below to create a frequency table that shows the counts and proportion of males and females in the data set. Describe your results and consider what this tells you about penguins in the Antarctica.
:::

::: {.callout-note title="Answer" collapse="true"}
```{r}

penguins %>%
  count(sex) %>%
  mutate(percent = n/sum(n)*100) %>%
  kable(digits = 1)

```

We see that we have a small number of individuals in the data set for which sex was not determined (`NA`). More importantly, we see that overall, the penguin populations comprise approximately the same amount of males and females.

Another option would be to count the number of individuals per male and female within each species.

```{r}

penguins %>%
  count(species, sex) %>%
  mutate(percent = n/sum(n)*100) %>%
  kable(digits = 1)

```

This gives us the additional insight that this pattern of equal number of male and females is consistent across all three species.

***Caveat**: We don't know if the the sampling scheme was designed to be random in respect to sex and thus represent the proportions in the species, or if it was more important to include similar numbers of males/females to be able to compare differences in the other metrics in the data set among sexes.*
:::

So far, we have been looking at frequencies of occurrences across the entire data set, however, in our case we have observations from three different islands. One question we probably have is whether the distribution of different penguin species is consistent across the different locations.

One of the advantages of using `R` is that we can add just one additional line of code to group our data by island and then count the number of observations per island.

```{r}

penguins %>%
  group_by(island) %>%               # group data by island
  count(species) %>%                 # count number of observations in each subset
  pivot_wider(names_from = species,  # create one column per species
              values_from = n) %>%   # add counts per island per island/species
  kable()

```

::: {.callout-tip title="Consider this"}
Describe your results and consider what this tells you about penguins in the Antarctica.
:::

::: {.callout-note title="Answer" collapse="true"}
Again, just by looking at simple descriptive stats comparing distribution of observations across these categories we have gained a lot of insight and we now see that the islands are quite different in terms of the which species are present. Adelie penguins are observed on every island, while Gentoo and Chinstrap penguins never co-occur, they are each observed on one island each, in which case they are the more common species compared to Adelie penguins.
:::

Both species and sex are categorical variables, so if we wanted to visualize the distribution we would typically use a **bar chart** where we plot the different categories of a value on the x axis and then scale the height of each bar to correspond to the number of individuals observed.

We can do this using the function `ggplot()`[^a04_descript-stats-11].

[^a04_descript-stats-11]: We aren't going to go into detail how to customize figures using ggplot, but you can use the comments to see what modifications you would be able to make to e.g. change color coding etc.

::: {.callout-tip title="Give it a try"}
Add a descriptive figure caption and x/y-axis titles[^a04_descript-stats-12].

```{r}
#| label: fig-species 
#| fig-cap: "Number of individuals observed per species."   

ggplot(penguins, aes(x = species)) +  # specify data frame and column name to plot on x-axis   
  geom_bar(stat = "count",            # define chart type as bar plot            
           color = "black",           # define color of bar lines            
           fill = "darkorange") +     # define color of bars   
  labs(x = "species",                 # x axis label        
       y = "number of individuals") + # y axis label   
  theme_classic() 
```
:::

[^a04_descript-stats-12]: By giving this code chunk a label that starts with `fig` it will automatically number your figures.

We already know from looking at the frequency table that the patterns are quite different across the islands. We can similarly add a line of code to plot the counts for each island in a separate bar plot.

::: {.callout-tip title="Give it a try"}
Add a descriptive figure caption and x/y-axis titles.

```{r}
#| label: fig-species-island
#| fig-cap: "Number of individuals observed per species on each island."


# define colors to use
col <- c("darkorange", "purple", "cyan4")


ggplot(penguins,                             # define data set to plot
       aes(x = species,                      # define variables to plot on x axis
           fill = species)) +                # color code bars by species
  geom_bar(stat = "count",                   # define chart type as bar plot
           color = "black") +         
  facet_grid(. ~ island) +                   # create separate plots per island
  scale_fill_manual(values = col) +          # define colors for fill
  labs(x = "species",                        # x axis label
       y = "number of individuals") +        # y axis label
  theme_classic() +
  theme(legend.position = "bottom")          # place legend underneath figure


```
:::

### Grouped (binned) frequency distributions {#sec-grouped-(binned-frequency-distributions}

What about the distribution of some of the other values in our data set? For example, we have measured the body mass of each individual[^a04_descript-stats-13]. Therefore, we probably want to know what the distribution of body size is for each of the penguin species.

[^a04_descript-stats-13]: For second visualize a scientist with a scale and a bunch of penguins standing in line waiting to be weighed.

However, this data set is different from counting the number of individuals in a specific category like we did above, body weight is a **continuous** variable. In this case, we would use a **histogram** to visualize the distribution. We do this by grouping our observations into bins that represent equally sized groups of possible values.

::: {.callout-tip title="Give it a try"}
For example, we could create bins of 100g and then count how many individuals weigh between 0-50g, 50-100g etc. Then we can plot those bins on the x-xis and the scale each bar to correspond to the number of individuals whose weight falls into that bin.

Plot a histogram for each penguin species using the table below, and consider how this helps summarize your data.

```{r}
#| label: fig-body-mass
#| fig-cap: "Distribution of body weight for each species."

ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 100,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```
:::

::: {.callout-note title="Answer" collapse="true"}
Histograms are really helpful for exploring general patterns in the distribution of your data because you easily determine

-   All the values occurring in your data set
-   Which values occur more/less frequently (the "shape")
-   The center of your values
-   The amount of variability in your data

In short, assessing the distribution with a histogram gives you an idea of central tendency and variability of the data set as well - descriptive statistics that we'll dig into in just a bit.
:::

::: {.callout-tip title="Give it a try"}
We should think a little bit about how important choosing the "right" bin size is - or if there even is a "right" bin size. Manipulate the code below to try 3 different bin sizes. Compare the figures you produce with your lab mates sitting near you and briefly describe what you learn about picking the right bin size.
:::

::: {.callout-note title="Answer" collapse="true"}
```{r}

# try a small bin size
ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 10,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

# try a large bin size
ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 100,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

# try a REALLY LARGE bin size
ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 1000,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```

::: {.callout-tip title="Consider this"}
Let's spend a little bit of time thinking about how to correctly interpret a histogram.

Imagine you and two of your lab mates are riding your snowmobiles on one of the Antarctic islands in the study. You come across a Chinstrap penguin colony. They are very cute, so as you (carefully) drive through the penguins you randomly grab five of them (let's assume you have a little snowmobile side car). One of your lab mate comes across an Adelie penguin colony and also grabs 5 random penguins, while your last partner in crime nags 5 Gentoo penguins.

You meet back up at your research station - discuss with your lab mates how heavy you think each of your sets of penguins are. Be as specific as possible.

Bonus question - given your data set who do you think found their colony first?
:::

::: {.callout-note title="Answer" collapse="true"}
Given that your histogram shows values from roughly 2,500g to 5,000g for Adelie penguins, you can probably assumed that your penguins are somewhere in there. But you can be even more exact, if you carefully look at the height of the bars - they higher bar the more common than weight has been observed and this means that there is a higher probability that your penguins are in that weight bin.

Even though the absolute height of the bars is lower for Chinstrap penguins is smaller (because there are fewer in the data set), the distribution is actually quite similar and those two sets of penguins are probably quite similar in weight.

The smallest observed Gentoo penguins are about as large as the smallest Adelie and Chinstrap penguins. They most commonly are observed to be between 4,500 and 5,500g - your penguins are likely around that size.
:::
:::

### Normal distribution {#sec-normal-distribution}

The data set can have a wide range of shapes and the shape itself will give you some insight into the statistical properties which can be useful down the line, as you make decisions about for example what statistical test to apply[^a04_descript-stats-14].

[^a04_descript-stats-14]: Statistical tests make specific assumptions about the data, if those assumptions are violated your conclusions are not well supported even if your test results say they should be

One of the most well-understood distribution is called a **normal distribution**. Because it is bell-shaped it is also frequently referred to as the **bell curve**.

::: {.callout-tip title="Give it a try"}
Execute the code chunk below to generate a normally distributed data set and plot it.

Then take a look at the figure you just plotted and identify these key characteristics of a normal distribution:

-   There is a singe peak right around the center line.
-   Most of the observations are at the center of the distribution.
-   The distribution is symmetric around the center line.

```{r}
#| label: fig-norm-dist
#| fig-cap: "Distribution of 1,000 observations randomly drawn from a normal distribution with mean = 0 and standard deviation = 1."

# randomly draw values from a specified normal distribution
df <- rnorm(n = 1000,   # set number of observations
            mean = 0,   # determine mean
            sd = 1) %>% # set standard deviation
  as.data.frame() %>%
  setNames("obs")

# plot histogram
ggplot(df, aes(x = obs)) +
  geom_histogram(binwidth = 0.5,
                 color = "black", fill = "darkorange") +
  theme_classic()


```
:::

::: {.callout-tip title="Consider this"}
Take another look at your penguin body mass histograms and argue whether or not you think we can assume that body mass is normally distributed.

A good way to argue this is to take the list of key characteristics from the list above and explain whether or not you see this in your data set.

```{r}
#| label: fig-weight-histog-I
#| fig-cap: "Distribution of body weight for Adelie, Chinstrap, and Gentoo penguins. Weights are binned in 100g increments."

ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 100,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```
:::

One thing you will notice is that your choice of bin width will play a bit of a role. For example, let's re-plot the same figure with a slightly larger binwidth and see if you change your mind.

```{r}
#| label: fig-weight-histog-II
#| fig-cap: "Distribution of body weight for Adelie, Chinstrap, and Gentoo penguins. Weights are binned in 250g increments."

ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 250,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                  # create separate plot per species
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```

::: {.callout-tip title="Consider this"}
Another factor that we might need to consider is that our data set contains both males and females. Sexual dimorphism is common in animal species which can include that one sex is larger compared to the other.

Let's create separate plots of each species and sex. Then, re-consider whether or not you think the weight data is normally distributed.

```{r}
#| label: fig-weight-histog-sex
#| fig-cap: "Distribution of body weight for male and female Adelie, Chinstrap, and Gentoo penguins. Weights are binned in 150g increments."

ggplot(penguins, aes(x = body_mass_g,        # define data set & variable on x-axis
                     fill = species)) +      # color code by species
  geom_histogram(binwidth = 150,             # define bin width
                 color = "black") +
  facet_grid(sex ~ species) +                  # create separate plot per species and sex
  scale_fill_manual(values = col) +          # define color palette
  labs(x = "body mass [g]",                  # x-axis title
       y = "number of individuals") +        # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```
:::

### Sample vs Population {#sec-sample-vs-population}

Before we move on to the next statistic, let's take a moment to think about the difference between a **sample** and a **population**. Our data set is a **sample** of 344 penguins. That is the number of individuals that were observed. However, unless this was a comprehensive census in which the researchers tracked down every single penguin on those three islands this is only a subset of the actual **population**, which would be all available observations (in this case pengiuns) at a specific point in time for a specific define geographic region (in this case the three islands).

The goal is to take a sample that is representative of the population. The larger our sample, the larger the proportion of the population is included which means that our sample will more closely resemble the statistical attributes including the distribution of the population.

::: {.callout-tip title="Give it a try"}
Manipulate the code below to simulate 4 different normal distributions but for three different sample sizes and compare how this affects the distributions. Take a peak at your lab mate's plots as well, and see if your plots look the same for the same sample size. Assume that body mass of penguins is normally distributed, how large do you think sample sizes should be to make sure your sample is representative.
:::

::: {.callout-note title="Answer" collapse="true"}
```{r}

# use a small sample size
df <- rnorm(n = 10,   # set number of observations
            mean = 0,   # determine mean
            sd = 1) %>% # set standard deviation
  as.data.frame() %>%
  setNames("obs")

# plot histogram
ggplot(df, aes(x = obs)) +
  geom_histogram(binwidth = 0.25,
                 color = "black", fill = "darkorange") +
  theme_classic()

# use a medium size sample size
df <- rnorm(n = 100,   # set number of observations
            mean = 0,   # determine mean
            sd = 1) %>% # set standard deviation
  as.data.frame() %>%
  setNames("obs")

# plot histogram
ggplot(df, aes(x = obs)) +
  geom_histogram(binwidth = 0.25,
                 color = "black", fill = "darkorange") +
  theme_classic()

# use a large size sample size
df <- rnorm(n = 1000,   # set number of observations
            mean = 0,   # determine mean
            sd = 1) %>% # set standard deviation
  as.data.frame() %>%
  setNames("obs")

# plot histogram
ggplot(df, aes(x = obs)) +
  geom_histogram(binwidth = 0.25,
                 color = "black", fill = "darkorange") +
  theme_classic()


# use a REALLY large size sample size
df <- rnorm(n = 10000,   # set number of observations
            mean = 0,   # determine mean
            sd = 1) %>% # set standard deviation
  as.data.frame() %>%
  setNames("obs")

# plot histogram
ggplot(df, aes(x = obs)) +
  geom_histogram(binwidth = 0.25,
                 color = "black", fill = "darkorange") +
  theme_classic()

```

You should see that the smaller the sample size the more oddly shaped the distributions. If you regenerate a sample of a normal distribution for the same sample size you will also notice that for small sample sizes those plots jump around quite a bit.
:::

## Measures of central tendency {#sec-measures-of-central-tendency}

Measures of central tendency give us an estimate of the center (average) of a data set. This is a complicated (but very specific way) of way it tells us what the "average" is. Typically, when you hear the term average you probably are thinking of the **mean**, but other important metrics are the **median** and the **mode** which give us additional important information about a data set.

-   The **mean** is often used synonymous to average and the metric you are likely most familiar with. You calculate it by adding up all the values and divide by the total number of observations. This is metric is most informative when the data has a normal distribution.
-   The **median** is the value in the middle of the data set. This means that 50% of values fall below and 50% fall above. For a normal distribution the mean and the mode should be very similar. For skewed data sets this is a more approporiate metric to determine centrality.
-   The **mode** is most commonly observed value, it's not typically used in statistics, so we are going to skip it here.

Let's look at each one in a bit more detail.

### The mean {#sec-the-mean}

The **mean** is the sum of all the values divided by the **sample size** (number of observations or values). We can write this as a mathematical formula as follows

$$
\bar{x} = \sum x\_{n} = \frac{x_{1} + x_{2} + x_{3} + ... x_{n}}{n}
$$ {#eq-mean}

with $\bar{x}$ as the sample mean[^a04_descript-stats-15] , $n$ is the sample size[^a04_descript-stats-16], and $x_{n}$ being the individual observations.

[^a04_descript-stats-15]: It's important to note that we are almost always determining the **sample mean** \bar{x} and then use it as an estimate of the true **population mean** $\mu$.

[^a04_descript-stats-16]: If you are referring to the true size of the population we would generally denote that as $N$.

The @eq-mean is implemented in the base `R` function `mean()` which we can easily group our data by species using `group_by()` and then calculate the mean body mass using the function `summarize()`. We need to give it a column name for a summary statistic and then tell it how to calculate the contents for that column. In this case we will specify that we want to apply the function `mean()` to the column `body_mass_g`. We will use the argument `na.rm` to tell `R` to ignore any missing values.

```{r}

penguins %>%                                                       # define data frame
  group_by(species) %>%                                            # create subsets by species
  summarize(mean_body_mass = mean(body_mass_g, na.rm = TRUE)) %>%  # calculate mean
  kable(digits = 1)                                                # print table

```

### The median {#sec-the-median}

To determine the median by hand, you would first determine if there is an odd or an even number of observations. Then you need to order all your observations from smallest to largest. If there is an odd number of observations, the median is the middle value[^a04_descript-stats-17]. If you have an even number of observations you would determine the median by finding the values at the positions $\frac{n}{2}$ and $\frac{n+1}{2}$ and then the median is the mean of those two values.

[^a04_descript-stats-17]: You can determine that position as $\frac{n+1}{2}$ with $n$ being the sample size.

Fortunately, we again have a base `R` function (`median()`) that will allow us to quickly calculate the median for a set of values contained in a single column of a data frame. We can do this using the same functions as above, however, we will add an additional argument to the `summarize()` function that we would like to add a column called `median_body_mass` that should contain the values calculated by apply the function `median()` to the column `body_mass_g`, again we will specify to ignore any missing values.

```{r}

penguins %>%                                                           # define data frame
  group_by(species) %>%                                                # create subsets by species
  summarize(mean_body_mass = mean(body_mass_g, na.rm = TRUE),          # calculate mean
            median_body_mass = median(body_mass_g, na.rm = TRUE)) %>%  # calculate median
  kable(digits = 1)                                                    # print table

```

::: {.callout-tip title="Consider this"}
Compare and contrast the mean and median body weight for our three penguin data sets in the table you have just produced.

-   Discuss whether these values are surprising after having spent (maybe too much?) time looking at the histograms.
-   Consider what this means in the context of what you have learned about the distribution of data sets.
:::

::: {.callout-note title="Answer" collapse="true"}
Even though our Adelie and Chinstrap penguins differ slightly (33g) in their mean body mass, they have the same median weight. Gentoo penguins are on average 2,000g heaver.

In all three cases the mean and mode are almost identical, this is indicative of a normal distribution, if a distribution is skewed left (a long tail to the right) the median will be smaller than the mean and if it is skewed right (a long tail to the left) the median will be larger than the mean.
:::

## Measures of variability {#sec-measures-of-variability}

The last category we have to think about is what metrics we can use to describe the variance of the a data set. We use measures of centrality to describe the most typical values we should expect, however most things in nature are not the same. Therefore, we need metrics that tell us how different we should expect values to be from the mean or median to have a sense of how spread out the values are going to be.[^a04_descript-stats-18].

[^a04_descript-stats-18]: Think of this as you now knowing how heave a penguin is on average but you want to know how large you should expect the smallest and the largest penguins to be, how different on average the weight of a penguin is going to be from the mean.

Typical metrics that are used to describe variability are

-   the **range** tells us how far apart the observed values are; described either as the minimum and maximum observed value or as the difference between the two.
-   the **variance** is the average of the squared deviations of each value from the mean.
-   the **standard deviation** is the average amount of variability in the data set and describe how far away and observed value is from the mean on average.

### The range {#sec-the-range}

One of the most straight forward metrics we can determine to describe the variability of the data set is the **range**. To do this, we simply determine the highest and lowest value for a variable. We can easily add these values to the table we have been expanding by adding additional lines to apply the function `min()` and `max()` to the `body_weight_g` column.

```{r}

penguins %>%                                                           # define data frame
  group_by(species) %>%                                                # create subsets by species
  summarize(mean_body_mass = mean(body_mass_g, na.rm = TRUE),          # calculate mean
            median_body_mass = median(body_mass_g, na.rm = TRUE),      # calculate median
            min_body_mass = min(body_mass_g, na.rm = TRUE),            # determine largest value
            max_body_mass = max(body_mass_g, na.rm = TRUE)) %>%        # determine largest value
  kable(digits = 1) 

```

Even though the range is easy to determine and can be informative in some cases, it is actually rarely used as a measure of variability because the sample range does not always reflect the range of the actual population. There generally is a pattern where up to a certain point your range will increase with sample size.

::: {.callout-tip title="Consider this"}
We are going to plot all of our observations for body mass on the x-axis grouped by species. Use this figure to argue why using the range as a measure of variability can be misleading in some cases because it ignores important contextual information.

```{r}
#| label: fig-body-mass-jitter
#| fig-cap: "Observed body weight for Adelie, Chinstrap, and Gentoo pengiuns."

ggplot(penguins, aes(x = body_mass_g, y = species, fill = species)) +
  geom_jitter(size = 3, shape = 21, alpha = .4, height = .1) +
  scale_fill_manual(values = col) +
  labs(x = "body mass [g]", y = "species") +
  theme_classic() +
  theme(legend.position = "none")

```
:::

::: {.callout-note title="Answer" collapse="true"}
You can see that Chinstrap penguins have a wider range compared to the Adelie penguins but most of their points actually cluster more tightly compared to the other species. We don't know if this is just because their sample size is smaller and so we are more likely not to observe the full range of body weight exhibited by Gentoo populations or if these are true outliers.
:::

### Variance {#sec-variance}

One way we can avoid the issues that can be introduced by using the range to describe variability is to determine how far away each point is from the mean value (**deviation from the mean**).

Let's visualize this by plotting all the weights for the Chinstrap penguins on the x-axis and adding a line between each point and the mean.

```{r}
#| label: fig-deviation-mean
#| fig-cap: "Body weights for Chinstrap penguins. Red line indicates mean body mass. Black lines denote the deviation from the mean for each observation."

# create data frame with only chinstrap penguins
chinstrap <- penguins %>%
  filter(species == "Chinstrap") %>%
  rownames_to_column("indv")

# plot all observed weights
ggplot(chinstrap, aes(x = body_mass_g, y = indv)) +
  geom_vline(aes(xintercept = mean(body_mass_g, na.rm = TRUE)), 
             color = "darkred", size = 1) +
  geom_segment(aes(x = body_mass_g, xend = mean(body_mass_g),
                   yend = indv)) +
  geom_point(size = 3, shape = 21, fill = "cyan4") +
  labs(x = "body mass [g]") +
  theme_classic() +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())

```

At first glance, just summing up all the values seems like a simple solution to get the "total amount of deviation" in the data set. However, some of our values are positive while others are negative so that would be problematic because they will cancel each other out.

Instead, we need to square each deviation and then we can sum them up[^a04_descript-stats-19]. The greater the variability in our data, the greater the **sum of the squares**. We generally refer to the sum of the squared deviations as the **variance** $s^{2}$. To calculate the sample variance, you need to subtract each value from the sample mean, square each value, add up all the values, and then divide this sum by the number of samples minus 1[^a04_descript-stats-20].

[^a04_descript-stats-19]: Squaring the mean means that our values are always positive. It also means that values that are at extreme distances from the mean will have a greated effect on the variability.

[^a04_descript-stats-20]: We do this to correct for the fact that we are calculting the sample variance and not the variance of the true population.

$$
s^{2}=\frac{\sum (x_{i}-\bar{x})^2}{n-1}
$$ {#eq-variance}

With $x_{i}$ being in individual observation, $\bar{x}$ the sample mean, and $n$ the sample size.

Again, it is important that we differ between the sample variance that you can calculate using your data set and provides an estimate of the population variance.

You may have assumed that we can calculate this in R using a function called `variance()` - close, it is actually called `var()`, but you are correct that we can add the variance in body mass measurements for each penguin species to our summary stats table using the same syntax we have been applying.

```{r}

penguins %>%                                                           # define data frame
  group_by(species) %>%                                                # create subsets by species
  summarize(mean_body_mass = mean(body_mass_g, na.rm = TRUE),          # calculate mean
            median_body_mass = median(body_mass_g, na.rm = TRUE),      # calculate median
            min_body_mass = min(body_mass_g, na.rm = TRUE),            # determine largest value
            max_body_mass = max(body_mass_g, na.rm = TRUE),            # determine largest value
            var_body_mass = var(body_mass_g, na.rm = TRUE)) %>%         # calculate variance
  kable(digits = 1) 

```

::: {.callout-tip title="Consider this"}
Compare and contrast the **range** and the **variance** for body mass in across the different species and argue which metric you think is more informative.
:::

::: {.callout-note title="Answer" collapse="true"}
As indicate before, Adelie have a smaller range of body mass compared to Chinstrap penguins, however, we can see that the variance of Chinstrap is quite a bit smaller. Recall the visualization that showed that Chinstrap body weights points cluster closer together compared to Adelie pengiuns despite those extreme values that are creating the misleading greater range.
:::

### Standard deviation {#sec-standard-deviation}

One of the drawbacks of using the variance to describe variability is that because we have squared the deviations our unites are no longer meaningful[^a04_descript-stats-21], we can compare variance by magnitude but it is not helpful to say that the variance in Adelie penguin body weight is about 62,000 squared grams larger compared to Chinstrap penguins.

[^a04_descript-stats-21]: The we of course remain open to good ideas on how to interpret "square grams".

To get around this issue, we generally calculate the **standard deviation** $s$ by drawing the square root of the variance.

$$
s = \sqrt{s^{2}}
$$ {#eq-std}

We can add this to our summary stats table using the function `sd()`.

```{r}

penguins %>%                                                           # define data frame
  group_by(species) %>%                                                # create subsets by species
  summarize(mean_body_mass = mean(body_mass_g, na.rm = TRUE),          # calculate mean
            median_body_mass = median(body_mass_g, na.rm = TRUE),      # calculate median
            min_body_mass = min(body_mass_g, na.rm = TRUE),            # determine largest value
            max_body_mass = max(body_mass_g, na.rm = TRUE),            # determine largest value
            var_body_mass = var(body_mass_g, na.rm = TRUE),            # calculate variance
            std_body_mass = sd(body_mass_g, na.rm = TRUE)) %>%         # calculate standard deviation
  kable(digits = 1) 

```

::: {.callout-tip title="Consider this"}
We frequently report means as mean +/- the standard deviation. Describe your results comparing the body mass of these three species using this format.
:::

::: {.callout-note title="Answer" collapse="true"}
Gentoo penguins were observed to be the largest species with a mean body mass of 5,076g +/- 504g. Adelie and Chinstrap penguins are smaller with observed means of 3,700 +/- 458g and 3,733g +/- 384g, respectively, indicating that though on average they are similar in size, Adelie penguins exhibit a larger variability.
:::

## Homework {#sec-homework}

Complete the questions below to review some of what you have learned about descriptive statistics. Render your document as an html-file and submit that document through Canvas. Double check that you are submitting the html file, not the quarto document.

Our data set contains information on the flipper length for each individual in the data set.

::: {.callout-tip title="Consider this"}
Describe the individual steps you would complete to create a figure summarizing the distribution of the data.
:::

::: {.callout-caution title="Your Answer Here"}
\[Outline your steps here.\]
:::

::: {.callout-tip title="Give it a try"}
Modify and Execute the code chunk below to plot a histogram of flipper length by for each species.

-   Add a descriptive figure caption consisting of a concise title and a description that explains what is being displayed
-   add x and y-axis titles.
-   Adjust the binwidth (currently at 25) to a width you find appropriate and explain why you chose that number
-   Argue whether or not you can assume a normal distribution for flipper length.
:::

::: {.callout-caution title="Your Answer Here"}
Modify the figure by defining which data to plot on the x-axis and finding an appropriate binwidth:

```{r}
#| eval: false
#| label: fig-flipper
#| fig-cap: "Add figure title and description here."

ggplot(penguins, aes(x = columname, # define data set & variable on x-axis
                     fill = species)) +     # color code by species
  geom_histogram(binwidth = 25,             # define bin width
                 color = "black") +
  facet_grid(. ~ species) +                # create separate plot per species
  scale_fill_manual(values = col) +        # define color palette
  labs(x = "title",          # x-axis title
       y = "title") +      # y-axis title
  theme_classic() +
  theme(legend.position = "bottom")

```

\[Argue whether normal distribution\].
:::

::: {.callout-tip title="Consider this"}
Execute the code chunk below to calculate a series of descriptive statistics summarizing the flipper length measurements.

-   Explain the difference between measures of central tendency and variability and for metric in the table determine which category it falls under (Protip: A good way to set up an answer for a question like this is to first define a category, then pick a variable and state "this variable tells me ..., which falls into this category because ...".).
-   Consider which summary statistics you think are most informative and argue which two you would report if you were limited to reporting only two. (Protip: Since we have two categories you probably want one in each category. Then a good way to argue is to pick a metric, explain the information it conveys is important and then also explain why it does this better than other variables in that category).
-   Describe your results based on the metrics you chose.

```{r}
#| label: tbl-sum-stats

penguins %>%                                                       # define data frame
  group_by(species) %>%                                            # create subsets by species
  summarize(mean = mean(flipper_length_mm, na.rm = TRUE),          # calculate mean
            median = median(flipper_length_mm, na.rm = TRUE),      # calculate median
            min = min(flipper_length_mm, na.rm = TRUE),            # determine largest value
            max = max(flipper_length_mm, na.rm = TRUE),            # determine largest value
            var = var(flipper_length_mm, na.rm = TRUE),            # calculate variance
            sd = sd(flipper_length_mm, na.rm = TRUE)) %>%          # calculate sd
  kable(digits = 1) 

```
:::
