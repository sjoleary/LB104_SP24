{
  "hash": "83a18e9f7e073224d1f67be15b21b35b",
  "result": {
    "markdown": "\n# Allelopathy Data Analysis {#sec-allelopathy-data-analysis}\n\nLearning Objectives\n\n**After completing this activity you should be able to**\n\n* use `read_delim()`to read a tab-delimited file into `R` as a data.frame.\n* assess what information is contained in a data set.\n* decide what type of descriptive statistics to apply according to whether a variable is continuous or categorical.\n* use `ggplot()` to generate and modify barplots according to the type of data being visualized.\n* decide whether to apply a t-test or a $\\chi^{2}$-test depending on what type of metrics you are comparing.\n* distinguish between describing and interpreting results.\n\n\nWe are going to explore your results by applying the key concepts you have learned about descriptive and inferential stats. After completing this component you will use the provided template to write a lab report. You should refer to your methods and this analysis `quarto` documents to complete your methods and results sections. You will be able to pull your analysis section directly from this document^[cut and paste is your friend!] to produce the tables and/or figures you want to include in your report. Typically for your methods you would have sections describing your experimental design and data collection and how you did your analysis. You should make sure that you understand what we are doing here and why to describe each step in your report and then include the code to make that happen. \n\nIn your results section, refer to your figures/tables that you include as you describe your results. From this and previous chapters, remember that you can use the `label` code chunk option to give your code chunk a name, for code chunks that produce a figure if you preface that name with `fig` it will automatically number your figures  for you. Similarly, if it is a code chunk that produces a table, if you preface your label name with `tbl` it will automatically number your tables. You should use the `fig-cap` and `tbl-cap` code chunk options to include a figure/table caption. So for example if you are producing a bar plot for frequencies you could use `#| label: fig-bar` and then `#| fig-cap: \"Descriptive  figure caption` to get a number figure in your report.\n\nLet's load our `R` packages and get rolling!\n\n\n\n\n\n\n## Germination frequency\n\n### Get the data\n\nGo to the `GoogleSheet` that contains the germination counts for your lab and select the tab for your group. Double check that the data has been entered correctly. Then go to `File` -> `Download` -> `Tab Separated Values (.tsv)` down load your data as a tab-delimited file. Now, use your `File Explorer` if you are on a Windows computer and `Finder` of you are on a Mac and navigate to the `Downloads` folder. You should see the file you just downloaded there. Rename it to `gemination_plant.tsv` depending on the plant you are testing and place it in the `data` folder of your `02_Allelopathy` project folder. \n\nOnce you go back to your `Rstudio` window with your `Rproj` loaded you should see the file in your `data` folder in the `Files` pane. Double check that it is there, if not, as you instructor to help you get set up.\n\nNow we are ready to read in our germination data as a `data.frame` that we can compute on in `R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define your filename\nfile <- \"germination_demo-1.tsv\" # CHANGE THIS TO YOUR EXACT FILENAME, remember R is case sensitive\n\n# read in data\ngermination <- read_delim(here(\"data\", file), delim = \"\\t\") %>%\n  clean_names()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 120 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr  (5): test-plant, replicate, treatment, germination, time-recorded\ndbl  (1): seedling\nlgl  (1): notes\ndate (2): date-setup, date-recorded\ntime (1): time-setup\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n# take a look at first few lines\nhead(germination)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 10\n  test_plant replicate  treatment seedling germination    date_setup time_setup\n  <chr>      <chr>      <chr>        <dbl> <chr>          <date>     <time>    \n1 plant      lastname-1 ctrl             1 germinated     2023-01-12 09:00     \n2 plant      lastname-1 ctrl             2 germinated     2023-01-12 09:00     \n3 plant      lastname-1 ctrl             3 germinated     2023-01-12 09:00     \n4 plant      lastname-1 ctrl             4 germinated     2023-01-12 09:00     \n5 plant      lastname-1 ctrl             5 germinated     2023-01-12 09:00     \n6 plant      lastname-1 ctrl             6 no germination 2023-01-12 09:00     \n# ℹ 3 more variables: date_recorded <date>, time_recorded <chr>, notes <lgl>\n```\n:::\n:::\n\n\n\n::: {.callout-tip title=\"Consider this\"}\n\nTake a look at the `data.frame` object holding your data by clicking on it in the `Environment` pane (bottom left) or using `View(germination)`.\n\nDescribe how your data is organized:\n\n* what information is in each row?\n* what information is in each column?\n\nAssess what type of data you have \n\n* is it continuous or categorical?\n* what groups are you comparing?\n\nThen determine which descriptive statistics are appropriate to summarize this data set and how you would visualize your data.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nEach row represents one seed. And each column contains information for one variable.\n\nYour data is categorical with two possible values \"germinated\" and \"not germinated\" and you have two groups (treatments) you are comparing \"Control\" and \"Experiment\".\n\nWe want to know the total number of seeds that germinated and did not germinate across all replicates, and what proportion of the total number of seeds germinated.\n\nBecause we have categorical data and want to visualize how the data is distributed across our categories, we will want to use a bar plot to visualize our data.\n\n:::\n\n\n### Summarize your results\n\n::: {.callout-tip title=\"Consider this\"}\n\nYour `data.frame` contains the raw data.\n\nSuggest 2-3 ways that you can summarize your data in a meaningful way to describe your results in the context of the hypothesis you are exploring with this experiment. Explain why you think these would be appropriate data analysis methods.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nWe are going to calculate the total number and relative proportion of seeds that germinated for each treatment.\n\n:::\n\n\n::: {#tbl-germination-success .cell tbl-cap='Summary of germination success after 48 hrs. Total number (n) and percent of seeds that germinated.'}\n\n```{.r .cell-code}\ngermination %>%\n  group_by(treatment) %>%             # group data by treatment\n  count(germination) %>%              # count number seeds germinated\n  mutate(percent = n/sum(n)*100) %>%\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|treatment |germination    |  n| percent|\n|:---------|:--------------|--:|-------:|\n|ctrl      |germinated     | 39|   65.00|\n|ctrl      |no germination | 21|   35.00|\n|exp       |germinated     | 26|   43.33|\n|exp       |no germination | 34|   56.67|\n:::\n:::\n\n\nThis table gives you two summary statistics, but the table might not be the best way to present your data for easy comparison.\n\nData visualizations are frequently more helpful present your results compared to tables with numbers, so let's create a grouped bar chart visualizing our results. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pick two colors for your control and experimental treatment\ncolors <- c(\"darkorange\", \"cyan4\")\n\n\n# create bar plot with counts\nggplot(germination, aes(x = treatment,          # specify categories on x axis\n                        fill = germination)) +  # specify how to group data\n  geom_bar(stat = \"count\",                      # length of bar indicates number of observations\n           width = .75,                         # space between groups\n           position = position_dodge(.8),       # space between bars in group\n           color = \"black\") +                   # line color\n  scale_fill_manual(values = colors) +          # use custom colors\n  labs(x = \"Treatment\",                         # x-axis title\n       y = \"Number of Seeds\") +                 # y-axis title\n  theme_classic() +                             # specify theme\n  theme(legend.position = \"bottom\")             # place legend under figure\n```\n\n::: {.cell-output-display}\n![Germination success of radish seeds exposed to odiferous plant material. Number of seeds that germinated (orange) and did not germinate (green) after 48 hours for control (ctrl; no exposure) and experimental treatment (exp).](08_allelopathy-analysis_files/figure-html/fig-germination-success-1.png){#fig-germination-success width=672}\n:::\n:::\n\n\n::: {.callout-tip title=\"Give it a try\"}\n\nUsually for your report you would chose to either include a table or a visualization that summarizes your data. In either case you would include a descriptive figure or table title/caption that describes how to interpret the figure^[As a rule of thumb, you should have enough information in the caption that the reader can understand the figure even without reading the methods/results].\n\nThen you describe your results referencing your figure/table, however, your reader should be able to have the full picture of your results even without seeing the actual figure/table. A good template to use is to start with the broad pattern and then highlight important details. A good description of results contextualizes them for the reader^[For example, instead of just listing out values provide context and help your reader see the patterns by using terms like \"higher\" \"lower\", \"similar\" or highlighting certain results as \"notably, ...\", \"except for...\".]. You have already done all the thinking, guide your reader through what you've found.\n\nDescribe your results^[Consider this thinking out loud in a way where you have a set of notes that you can then edit for your report.]. Remember, at this point you should not be interpreting them.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nYour description could look something like this:\n\nBroad pattern:\n\n> Radish seeds exposed to plant had a 22% lower germination success compared to the control. \n\nDetails\n\n> Overall, a total of 39 seeds (65%) germinated in the control, while only 26 (43%) germinated in the experimental treatment (Figure xx).\n\nIt's important that we add this context because it is quite different if 100% germinated in the control and 78% in the experimental treatment or something more similar to what we observe here.\n\n:::\n\nDescriptive statistics are the important first step to summarizing our findings. However, as you know, at this point we don't know if our observed differences in germination success are just due to sampling error or if they actually represent reality.\n\n::: {.callout-tip title=\"Consider this\"}\n\nArgue which type of statistical test we should apply and outline the key steps you will need to take to perform the test.\n\n:::\n\n### Test for statistical significance\n\nWe need to apply a chi^{2}$ test to evaluate the difference between frequencies.\n\n::: {.callout-tip title=\"Give it a try\"}\n\nState your null and alternative hypothesis and predict the outcome if the claim is true.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nYour null hypothesis is a claim that there is no effect:\n\n* $H_{0}$: Presence of plant X does not have an effect on the germination rate of radish seeds.\n* Prediction: The number of seeds that germinate are not different between the experimental treatment and the control.\n\nThe alternative hypothesis is a claim that there is an observed effect.\n\n* $H_{0}$: Presence of plant X has a negative effect on the germination rate of radish seeds.\n* Prediction: The number of seeds that germinate for seeds exposed to plant X will be lower compared to the control.\n\n:::\n\n::: {.callout-tip title=\"Consider this\"}\n\nWe will specify our significance threshold $\\alpha$ as 0.05.\n\nExplain what this means and why it is important for us to specify this.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nThis means that if our observed results have a less than 5% probability occurring according to our null distribution we will reject our null hypothesis.\n\n:::\n\nOur next step is to calculate our observed test statistic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate observed statistic\nobserved_statistic <- germination %>%        # define data to use\n  specify(response = germination,            # specify response (dependent) variable\n          success = \"germinated\",            # specify response that is success\n          explanatory = treatment,  ) %>%    # specify explanatory (independent) variable\n  hypothesize(null = \"independence\") %>%     # define null hypothesis\n  calculate(stat = \"Chisq\",                  # define test statistic to use \n            order = c(\"ctrl\", \"exp\"))        # order to subtract explanatory variables\n\n# print test statistic\nobserved_statistic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResponse: germination (factor)\nExplanatory: treatment (factor)\nNull Hypothesis: independence\n# A tibble: 1 × 1\n   stat\n  <dbl>\n1  4.83\n```\n:::\n:::\n\n\nNow, let's simulate our null distribution and compare how our observed test statistic compares.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create null distribution\nnull_dist <- germination %>%\n  specify(response = germination,            # specify response (dependent) variable\n          success = \"germinated\",            # specify response that is success\n          explanatory = treatment,  ) %>%    # specify explanatory (independent) variable\n  hypothesize(null = \"independence\") %>%     # define null hypothesis\n  generate(reps = 1000,                      # number of samples to generate null distribution\n           type = \"permute\") %>%             # shuffle to break association\n  calculate(stat = \"Chisq\",                  # define test statistic to use \n            order = c(\"ctrl\", \"exp\"))        # order to subtract explanatory variables\n\n\n# visualize null distribution test statistic\nnull_dist %>%\n  visualize(method = \"both\") + \n  shade_p_value(observed_statistic,\n                direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Check to make sure the conditions have been met for the theoretical\nmethod. {infer} currently does not check these for you.\n```\n:::\n\n::: {.cell-output-display}\n![Null distribution of chi-square test statistic assuming presence of plant material has no effect on radish seed growth. Bars indicates permuted null distribution, black line indicates theoretical chi-square distribution. The calculated chi-square test statistic is indicated by the red line. Values observed in the null distribution that are more extreme that the t-statistic calculated for the empirical data set are shaded in red.](08_allelopathy-analysis_files/figure-html/fig-null-dist-chi-test-1.png){#fig-null-dist-chi-test width=672}\n:::\n:::\n\n\nAnd for our last step, we need to get our p-value^[Note: for your report, you do not need to visualize your null distribution we are doing this to help us get a better feel for how statistical tests worth. You can combine content from code chunks to go straight to getting your p-value.]:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# obtain p-value\nnull_dist %>%\n  get_p_value(obs_stat = observed_statistic,\n              direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.028\n```\n:::\n:::\n\n\n::: {.callout-tip title=\"Give it a try\"}\n\nCompare your p-value to the threshold of significance we defined above to determine how to interpret the results of your chi^{2}$-test.\n\nThen update the results you formulated earlier to add this information into your description of the results.\n\nFinally, write a few sentences as a draft of how you would include this in the discussion of your results, i.e. how you will interpret your results to draw a conclusion in the context of our broad research hypothesis that we designed this experiment to explore.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nIn this case our p-value is 0.023 which means that is a less than 2.3% probability that we would observe a test statistic at least this extreme give our null hypothesis. \n\nThis value is smaller than our specified threshold of significance and therefore we will reject our null hypothesis and conclude that the difference in the observed germination rates is statistically significant and consistent with our hypothesis that plant X has an effect on the germination rate.\n\nWe can augment our results to include this information:\n\n> Radish seeds exposed to plant had a 22% lower germination success compared to the control. Overall, a total of 39 seeds (65%) germinated in the control, while only 26 (43%) germinated in the experimental treatment (Figure xx). This difference is statistically significant (p = 0.02).\n\nIn the discussion we would interpret our results:\n\n> The germination rate of radish seeds was significantly lower when they were exposed to plant X (Figure X). This is consistent with our hypothesis that plant X is releasing an allelopathic chemical compound which impacts radish seed germination.\n\n:::\n\nRemember, if your results are not statistically significant, you still need to write a set of conclusions! Even though we seem to think that \"negative results\" are \"bad\", \"negative\" just means that we did not observe an effect - but that is also a result because you can now exclude one possible explanation for your observation and move on to test the next one.\n\n\n## Seedling growth\n\n### Get your data\n\nGo to the `GoogleSheet` that contains the seedling lengths for your lab and select the tab for your group. Double check that the data has been entered correctly. Then go to `File` -> `Download` -> `Tab Separated Values (.tsv)` down load your data as a tab-delimited file. Now, use your `File Explorer` if you are on a Windows computer and `Finder` of you are on a Mac and navigate to the `Downloads` folder. You should see the file you just downloaded there. Rename it to `seedling-length_plant.tsv` depending on the plant you are testing and place it in the `data` folder of your `02_Allelopathy` project folder. \n\nOnce you go back to your `Rstudio` window with your `Rproj` loaded you should see the file in your `data` folder in the `Files` pane. Double check that it is there, if not, as you instructor to help you get set up.\n\nNow we are ready to read in our germination data as a `data.frame` that we can compute on in `R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define your filename\nfile <- \"seedling-length_demo-1.tsv\" # CHANGE THIS TO YOUR EXACT FILENAME, remember R is case sensitive\n\n# read in data\nlength <- read_delim(here(\"data\", file), delim = \"\\t\") %>%\n  clean_names()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 40 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (3): test-plant, replicate, treatment\ndbl (2): individual, length_mm\nlgl (1): notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n# take a look at first few lines\nhead(length)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  test_plant replicate individual treatment length_mm notes\n  <chr>      <chr>          <dbl> <chr>         <dbl> <lgl>\n1 plant-1    test-1             1 ctrl              9 NA   \n2 plant-1    test-1             2 ctrl             10 NA   \n3 plant-1    test-1             3 ctrl              5 NA   \n4 plant-1    test-1             4 ctrl              8 NA   \n5 plant-1    test-1             5 ctrl              8 NA   \n6 plant-1    test-1             6 ctrl              7 NA   \n```\n:::\n:::\n\n\n\n### Summarize your results\n\n::: {.callout-tip title=\"Consider this\"}\n\nTake a look at the `data.frame` object holding your data by clicking on it in the `Environment` pane (bottom left) or using `View(length)`.\n\nDescribe how your data is organized:\n\n* what information is in each row?\n* what information is in each column?\n\nAssess what type of data you have \n\n* is it continuous or categorical?\n* what groups are you comparing?\n\nThen determine which descriptive statistics are appropriate to summarize this data set and how you would visualize your data.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nEach row represents one seedling. And each column contains information for one variable.\n\nYour data is continuous; you have a length measurement in millimeters. You have two groups (treatments) you are comparing \"Control\" and \"Experiment\" which is categorical.\n\nYou will want to determine the mean and standard deviation of the seedling length for both treatments. It could also be helpful to generate additional summary statistics including median, minimum and maximum values to give yourself an overview of the data.\n\nWe can explore to visualizations for your data, the first is that you can visualize the distributions using a histogram, the second is that you can visualize the mean and standard deviation using a bar chart or similar.\n\n:::\n\n::: {.callout-tip title=\"Consider this\"}\n\nSuggest 3-4 metrics to summarize your data in a meaningful way that will allow you to describe your results in the context of the hypothesis you are exploring with this experiment. \n\nExplain why you think these would be appropriate data analysis methods.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nAs we have continuous data, we can use the descriptive statistics we have discussed previously that allow us to assess the distribution (histogram), central tendency (mean, median, mode) and variability (variance, standard deviation) of our data.\n\n:::\n\nLet's start by putting together a table with summary statistics.\n\n\n::: {#tbl-summary-length .cell tbl-cap='Summary statistics for seedling length. Mean, median, standard deviation (sd), minimum (min) and maximum (max) length in millimeters for seedlings exposed to plant X (exp) or not (ctrl).'}\n\n```{.r .cell-code}\nlength %>%                                # specify data\n  group_by(treatment) %>%                 # group by treatment\n  summarize(mean = mean(length_mm),       # calculate mean\n            sd = sd(length_mm),           # calculate standard deviation\n            median = median(length_mm),   # determine median value\n            min = min(length_mm),         # determine minimum value\n            max = max(length_mm))         # determine maximum value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 6\n  treatment  mean    sd median   min   max\n  <chr>     <dbl> <dbl>  <dbl> <dbl> <dbl>\n1 ctrl        8.4  1.47      9     5    11\n2 exp         6.2  1.70      6     3    10\n```\n:::\n:::\n\n\n::: {.callout-tip title=\"Give it a try\"}\n\nDescribe your results^[Consider this thinking out loud in a way where you have a set of notes that you can then edit for your report.]. Make sure that you are being specific and adding context to make it easy for your reader to identify the key patterns. \n\nAs rule of thumb, you should describe your results so that your reader has all the key information they need even without seeing the data tables.\n\nRemember, at this point you should not be interpreting your results!\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nYour description could look something like this:\n\nBroad pattern:\n\n> Overall, seedling growth was lower for radish seeds exposed to plant X compared to the control. \n\nDetails\n\n> Mean seedling growth after 1 week was 6.2 +/- 1.7mm for plants exposed to plant X compared to a mean length of 8.4 +/- 1.47mm in the control. Similarly, the variability in seedling length was higher in exposed radish seeds (range = 3 - 10) compared to the control (range = 5 - 11).\n\nIn this case, you would not need to include table because you've included all the values, rather you might chose to include figure that effectively summarizes your data that you would then reference here.\n\n:::\n\nAgain, data visualizations are an important tool to summarize and present your data. Let's start by visualizing our data with a histogram which emphasize the distribution of our values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(length, aes(x = length_mm, fill = treatment)) +\n  geom_histogram(binwidth = 1,\n                 color = \"black\") +\n  facet_grid(treatment ~ .) +\n  scale_fill_manual(values = colors) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Seedling length distribution after 1 week for radish seeds explosed to plant X (green) and not (orange).](08_allelopathy-analysis_files/figure-html/fig-length-histogram-1.png){#fig-length-histogram width=672}\n:::\n:::\n\n\nAlternatively, we could create a bar plot where the height is scaled relative to the mean. This also allows us to add error bars that are scaled to the length of the standard deviation^[This is a classic plot for experiments with multiple treatments].\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create dataframe with mean and sd\nsummary <- length %>%\n  group_by(treatment) %>%\n  summarise(mean = mean(length_mm),\n            sd = sd(length_mm))\n\nggplot(summary) +\n  geom_bar(aes(x = treatment, y = mean,\n               fill = treatment),\n           stat = \"identity\",\n           color = \"black\") +\n  geom_errorbar(aes(x = treatment,\n                    ymin = mean-sd,\n                    ymax = mean+sd),\n                width = 0.25,\n                size = 1.2) +\n  scale_fill_manual(values = colors) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![Mean seedling length and standard deviation after 1 week for radish seeds explosed to plant X (green) and not (orange).](08_allelopathy-analysis_files/figure-html/fig-length-bar-1.png){#fig-length-bar width=672}\n:::\n:::\n\n\nBar plots take up a lot of \"ink\" and so an alternative is to create a plot using a point range. In that case the mean is represented by a point and the standard deviation by lines extending out from that point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create dataframe with mean and sd\nsummary <- length %>%\n  group_by(treatment) %>%\n  summarise(mean = mean(length_mm),\n            sd = sd(length_mm))\n\n# create dataframe with mean and sd\nsummary <- length %>%\n  group_by(treatment) %>%\n  summarise(mean = mean(length_mm),\n            sd = sd(length_mm))\n\nggplot(summary) +\n  geom_pointrange(aes(x = treatment,\n                    y = mean,\n                    ymin = mean-sd,\n                    ymax = mean+sd,\n                    color = treatment),\n                size = 1.2) +\n  scale_color_manual(values = colors) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Mean seedling length and standard deviation after 1 week for radish seeds explosed to plant X (green) and not (orange).](08_allelopathy-analysis_files/figure-html/fig-length-point-1.png){#fig-length-point width=672}\n:::\n:::\n\n\nAgain, our set of summary statistics and data visualization enable us to present the patterns in our data set. However, at this point we cannot make statement whether our observed differences in seedling lengths are within the range of variability in growth we would expect to see even if the plant material does not have an effect on growth.\n\n::: {.callout-tip title=\"Consider this\"}\n\nArgue which type of statistical test we should apply and outline the key steps you will need to take to perform the test.\n\n:::\n\n### Test for significance\n\nWe need to apply a $t$-test to evaluate the difference between means.\n\n::: {.callout-tip title=\"Give it a try\"}\n\nState your null and alternative hypothesis and predict the outcome if each claim is true.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nYour null hypothesis is a claim that there is no effect:\n\n* $H_{0}$: Presence of plant X does not have an effect on the growth rate of radish seeds.\n* Prediction: The seedling length does not differ between the experimental treatment and the control.\n\nThe alternative hypothesis is a claim that there is an observed effect.\n\n* $H_{0}$: Presence of plant X has a negative effect on the growth rate of radish seeds.\n* Prediction: The seedling length for seeds exposed to plant X will be lower compared to the control.\n\n:::\n\n::: {.callout-tip title=\"Consider this\"}\n\nWe will specify our significance threshold $\\alpha$ as 0.05.\n\nExplain what this means and why it is important for us to specify this.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nThis means that if our observed results have a less than 5% probability occurring according to our null distribution we will reject our null hypothesis.\n\n:::\n\nOur next step is to calculate our observed test statistic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate observed statistic\nobserved_statistic <- length %>%             # define data to use\n  specify(response = length_mm,              # specify response (dependent) variable\n          explanatory = treatment,  ) %>%    # specify explanatory (independent) variable\n  calculate(stat = \"diff in means\",          # define test statistic to use \n            order = c(\"ctrl\", \"exp\"))        # order to subtract explanatory variables\n\n# print test statistic\nobserved_statistic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResponse: length_mm (numeric)\nExplanatory: treatment (factor)\n# A tibble: 1 × 1\n   stat\n  <dbl>\n1   2.2\n```\n:::\n:::\n\n\nNow, let's simulate our null distribution and compare how our observed test statistic compares.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create null distribution\nnull_dist <- length %>%\n  specify(response = length_mm,              # specify response (dependent) variable\n          explanatory = treatment,  ) %>%    # specify explanatory (independent) variable\n  hypothesize(null = \"independence\") %>%     # define null hypothesis\n  generate(reps = 1000,                      # number of samples to generate null distribution\n           type = \"permute\") %>%             # shuffle to break association\n  calculate(stat = \"diff in means\",          # define test statistic to use \n            order = c(\"ctrl\", \"exp\"))        # order to subtract explanatory variables\n\n\n# visualize null distribution test statistic\nnull_dist %>%\n  visualize() + \n  shade_p_value(observed_statistic,\n                direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in min(diff(unique_loc)): no non-missing arguments to min; returning\nInf\n```\n:::\n\n::: {.cell-output-display}\n![Null distribution of t test statistic assuming presence of plant material has no effect on radish seed growth. The calculated t-square test statistic is indicated by the red line. Values observed in the null distribution that are more extreme that the t-statistic calculated for the empirical data set are shaded in red.](08_allelopathy-analysis_files/figure-html/fig-null-dist-t-test-1.png){#fig-null-dist-t-test width=672}\n:::\n:::\n\n\nAnd for our last step, we need to determine our p-value.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# obtain p-value\nnull_dist %>%\n  get_p_value(obs_stat = observed_statistic,\n              direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Please be cautious in reporting a p-value of 0. This result is an\napproximation based on the number of `reps` chosen in the `generate()` step.\nSee `?get_p_value()` for more information.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1       0\n```\n:::\n:::\n\n\n::: {.callout-tip title=\"Give it a try\"}\n\nCompare your p-value to the threshold of significance we defined above to determine how to interpret the results of your chi^{2}$-test.\n\nThen update the results you formulated earlier to add this information into your description of the results.\n\nFinally, write a few sentences as a draft of how you would include this in the discussion of your results, i.e. how you will interpret your results to draw a conclusion in the context of our broad research hypothesis that we designed this experiment to explore.\n\n:::\n\n::: {.callout-note title=\"Answer\" collapse=\"true\"}\n\nIn this case our p-value is 0.001 which means that is a less than 0.1% probability that we would observe a test statistic at least this extreme give our null hypothesis. \n\nThis value is smaller than our specified threshold of significance and therefore we will reject our null hypothesis and conclude that the difference in the observed germination rates is statistically significant and consistent with our hypothesis that plant X has an effect on the germination rate.\n\nWe can augment our results to include this information:\n\n> Overall, seedling growth was significantly lower for radish seeds exposed to plant X compared to the control (p = 0.001). Mean seedling growth after 1 week was 6.2 +/- 1.7mm for plants exposed to plant X compared to a mean length of 8.4 +/- 1.47mm in the control. Similarly, the variability in seedling length was higher in exposed radish seeds (range = 3 - 10) compared to the control (range = 5 - 11).\n\nIn the discussion we would interpret our results:\n\n> The growth rate of radish seeds was significantly lower when they were exposed to plant X (Figure X). This is consistent with our hypothesis that plant X is releasing an allelopathic chemical compound which impacts radish seed growth.\n\n:::\n\nRemember, if your results are not statistically significant, you still need to write a set of conclusions! Even though we seem to think that \"negative results\" are \"bad\", \"negative\" just means that we did not observe an effect - but that is also a result because you can now exclude one possible explanation for your observation and move on to test the next one.\n\n",
    "supporting": [
      "08_allelopathy-analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}